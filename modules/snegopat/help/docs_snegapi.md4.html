<html><head>
                <link rel="stylesheet" href="../www/md.css" type="text/css"/>
                <title>Метод v8New</title></head><body><h3 id="метод-v8new">Метод v8New</h3><a name="метод-v8new"></a>
<blockquote>
<p>Портирован полностью</p>
</blockquote>
<p>Создает новый объект 1С.<br>Синтаксис:</p>
<pre><code>v8New(ИмяТипа, [Параметры для конструктора...])
</code></pre><p>Аналог оператора <strong>Новый</strong> языка 1С.</p>
<p>Параметры:</p>
<ul>
<li>ИмяТипа. Обязательный. Строка. Содержит имя типа создаваемого объекта.</li>
<li>[Параметры для конструктора...]. Необязательный набор параметров любого типа, разделенных запятой.
Все параметры передаются в конструктор объекта.</li>
</ul>
<p>Возвращает: ссылку на созданный объект.</p>
<p>Как оказалось, в среде Конфигуратора можно также как и в Предприятии содавать многие объекты.
Конечно, не все - объекты, требующие подключения к данным, либо объекты прикладные (связанные с созданными
метаданными), создать нельзя. Список того, что можно попробовать создать в v8new размещен на форуме снегопата
в разделе &quot;Скрипты&quot;. Не факт, что все из этих объектов заработают.</p>
<p>Кроме того, так как сама 1С &quot;заточена&quot; для работы через COM - все объекты из внутреннего типа 1С могут
быть преобразованы самим движком 1С в IDispatch и уложены в VARIANT. Вот это то и позволяет потом
легко использовать созданные объекты в скриптах! То есть снегопат создает объект внутреннего типа 1С,
вызывает метод 1С valueToVariant - и получает готовый OLE-объект. С которым уже легко могут работать
другие аддины и скрипты - вызывать их методы, работать со свойствами, обходить коллекции и т.д.
JScript позволяет использовать русские буквы в названиях, так что часть кода можно напрямую
брать из готового кода 1С, VBScript - нет, можно использовать только английские названия методов и
свойств.</p>
<p>Пример:</p>
<pre><code>var vt = v8New(&quot;ТаблицаЗначений&quot;)
vt.Колонки.Добавить(&quot;Кол1&quot;)
....
var fileInfo = v8New(&quot;Файл&quot;, filePath)
if(fileInfo.Существует())
{
}
....
var КонструкторФорматнойСтроки = v8New(&quot;КонструкторФорматнойСтроки&quot;);
КонструкторФорматнойСтроки.ДоступныеТипы = v8New(&quot;ОписаниеТипов&quot;, &quot;Дата&quot;);
if (КонструкторФорматнойСтроки.ОткрытьМодально())
    addToSignatureFormat(form, &quot;ДатаВремя#&quot; + КонструкторФорматнойСтроки.Текст);
</code></pre><p><a name="Message"></a></p>
</body>