<html><head>
                <link rel="stylesheet" href="../www/md.css" type="text/css"/>
                <title>Объект IEventConnector</title></head><body><h2 id="объект-ieventconnector">Объект IEventConnector</h2><a name="объект-ieventconnector"></a>
<blockquote>
<p>Портировано полностью</p>
</blockquote>
<p>Объект предназначен для организации системы работы с событиями, позволяет одним объектам
реагировать на события, порожденные другим объектом, подписываясь и отписываясь в любое время
на любое из них. Служит для замены стандартного для OLE-Automation интерфейса IConnectionPoint.</p>
<p>Событие всегда характеризуется объектом - источником события и именем события. При подписке и отписке
указывается объект - приемник события и имя метода - обработчика события этого объекта.
На каждое событие может быть подписано несколько обработчиков. Все они выполняются в порядке
подписки. Имя события - регистро<strong>НЕ</strong>зависимое (в отличии от прошлого API). Пример подписки на событие:</p>
<pre><code>function onIdle()
{
    .....
}
events.connect(Designer, &quot;onIdle&quot;, SelfScript.self)
</code></pre><p>В Snegopat-Reborn можно при подписке на событие указывать имя метода-обработчика, как &quot;-&quot;.
В этом случае у объекта-обработчика не ищется метод по его имени, а вызывается метод &quot;по умолчанию&quot;,
т.е.  номером 0. Для объектов-функций JScript - это непосредственно вызов функции. Таким образом,
можно подписчиком можно указать сразу анонимную &quot;inplace&quot; функцию, указав имя обработчика, как &quot;-&quot;:</p>
<pre><code>connect(Designer, &quot;onIdle&quot;, function() {doIdleWork()}, &quot;-&quot;);
</code></pre><p>Кроме того, методы connect и addCommandHandler теперь возвращают объект, описывающий подписку на событие.
У него можно при желании поменять объект-обработчик и имя метода. При отписке можно в методе disconnectNode
указать этот объект, не используя старый метод отписки с указанием объекта-обработчика и имени метода.</p>
</body>