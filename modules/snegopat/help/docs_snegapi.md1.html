<html><head>
                <link rel="stylesheet" href="../www/md.css" type="text/css"/>
                <title>Просмотр SnegAPI в исходниках</title></head><body><h2 id="просмотр-snegapi-в-исходниках">Просмотр SnegAPI в исходниках</h2><a name="просмотр-snegapi-в-исходниках"></a>
<p>Для функционирования SnegAPI мной была создана в snegopat.dll автоматическая трансляция объектов
AngelScript в IDispatch. Таким образом, реализация интерфейсов упрощается, взаимодействие кода
скриптов и снегопата упрощается. Поэтому, на первых порах всвязи с отсутствием полной документации
и библиотеки типов для детального знакомства с апи можно смотреть непосредственно код прикладного
слоя снегопата в папке <em>core\engine</em>. Начать можно с файла <em>com_designer.as</em>, в котором описан объект
<em>Designer</em>, а дальше смотреть его свойства и методы. Вообще, я стараюсь код объектов, реализующих
SnegAPI размещать в файлах с префиксом <em>&quot;com_&quot;</em>, и при портировании сохранять имена типов объектов.</p>
<p>При авто-трансляции объектов AngelScript в IDispatch применяется несколько правил:</p>
<ul>
<li>Экспортируются все публичные методы объекта, кроме начинающихся с &quot;_&quot;.</li>
<li>Методы, название которых начинается с &quot;get_&quot;, не имеющие параметров и имеющие возвращаемое
значение, экспортируются как чтение свойства с именем без &quot;get_&quot;, например, &quot;string get_name()&quot;
будет эскпортировано как свойство &quot;name&quot;, которое можно прочитать.</li>
<li>Методы, название которых начинаются с &quot;set_&quot;, имеющие тип &quot;void&quot; и один параметр, экспортируются
как свойство, доступное для записи, с именем без &quot;set_&quot;, например, &quot;void set_name(string)&quot;
будет эскпортировано как свойство &quot;name&quot;, которое можно присвоить.</li>
<li>Экспортируются все публичные свойства объекта, не начинающиеся с &quot;__&quot;.</li>
<li>Свойства, чье название начинается с &quot;_&quot;, экспортируются как read only свойства, без начального &quot;_&quot;.</li>
<li>Если последним параметром метода указан array\<Variant\> - метод считается с неопределённым
количество параметров. Все переданные после предпоследнего параметра аргументы укладываются
в массив Variant и передаются в метод.</li>
<li>Если возвращаемое значение указано как array&lt;Тип&gt; - возвращается объект, имеющий свойство length
(количество элементов в массиве) и метод item(индекс), возвращающий указанный элемент массива.</li>
</ul>
<p>Параметры передаются по значению.</p>
<hr>
<p><a name="Designer"></a></p>
</body>