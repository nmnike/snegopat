<html><head>
                <link rel="stylesheet" href="../www/md.css" type="text/css"/>
                <title>Установка центрального репозитария</title></head><body><h2 id="установка-центрального-репозитария">Установка центрального репозитария</h2><a name="установка-центрального-репозитария"></a>
<p>Для начала надо определиться, на какую машину устанавливать центральный репозитарий:</p>
<ul>
<li>Она должна иметь доступ в интернет для возможности синхронизации с snegopat.ru,
и к ней должны иметь доступ компьютеры остальных разработчиков для скачивания
обновлений с локального репозитария.</li>
<li>На этой машине будет только репозитарий снегопата, а не сам снегопат, так что
лицензий снегопата на него тратиться не будет, и это <strong>не обязательно</strong> должна быть
машина одного из разработчиков.</li>
<li>Лучше поставить его на один из серверов вашей компании.</li>
<li>Возможно развернуть его под любой из ОС, поддерживаемых fossil-scm:
Windows, Linux, BSD, MacOS и многие другие.</li>
</ul>
<p>Я опишу пока более подробно развертывание центрального репозитария под Windows.
После того, как вы определились с машиной, проще всего выполнить на ней первоначальную
установку снегопата из файла snegopat-setup.exe. При этом будет сразу склонирован
репозитарий с сайта снегопата, уже настроенный на синхронизацию с snegopat.ru.
При установке используйте логин и пароль одной из ваших копий снегопата.</p>
<p>В-принципе, в установленной копии кроме папки repo и fossil.exe более ничего не нужно,
можно удалять все остальное.</p>
<p>Затем надо настроить раздачу локального репозитария остальным пользователям. Лучше всего это
сделать, запустив fossil в качестве сервиса. Для этого в консоли в каталоге установленного
снегопата выполните команду:</p>
<pre><code>fossil winsrv create snegopat -S auto -P 9456 -R &quot;%cd%\repo&quot;
</code></pre><p>Здесь snegopat - имя создаваемого сервиса, 9456 - порт, на котором fossil будет принимать запросы.
И имя, и порт можно задать свои, соответственно исправив дальнейшие команды.
После создания сервиса можно его запустить:</p>
<pre><code>net start snegopat
</code></pre><p>Все, fossil запущен и готов принимать запросы от клиентов.</p>
<p>Теперь, чтобы синхронизировать репозитарий с сайтом snegopat.ru создайте в каталоге снегопата
файл update.cmd следующего содержимого:</p>
<pre><code>@echo off
fossil pull -R repo\core.fossil
fossil pull -R repo\scripts.fossil
</code></pre><p>Для обновления досточно запустить этот файл. Удобнее будет, если вы настроите его запуск в
планировщике. Запускать лучше под учетной записью пользователя, выполнявшего установку.</p>
<hr>
</body>